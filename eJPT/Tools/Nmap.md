A fast tool to discover hosts on a network, and open ports on hosts.

## Host Discovery
+ `nmap -sn ip/netmask`
+ The `-sn` flag prevents nmap from trying a port scan on discovered hosts

## Port scan
#### Commands:
+ By default, scans the most common 1000 ports
+ Basic [[TCP]] scan, all ports with service identification :
	+ `nmap -sV -p- IP`
	+ scans all ports with `-p-`
+ Basic [[UDP]] Scan :
	+ `nmap -sU IP`
	+ also identify services with `-sUV`
+ Scan for hosts and display common open ports :
	+ `nmap IP/CIDR --open`
+ For some systems, some kind of rate limitation can prevent scans from giving useful results. In that case, we can use a slower scan :
	+ `nmap -sV -p- --max-rate 1 IP`
	+ The rate is in packets/second

#### Useful flags :
+ `-Pn` to not do an [[ICMP]] test beforehand, useful for Windows targets
+ `-p 1-10000` to scan ports between 1 and 10000
+ `-sV` for identification of service versions
+ `-vv` for increased verbosity
+ `-F` for only the most common 100 ports
+ `-O` for OS detection, often unreliable
+ `-sC` runs scripts based on the detected open ports to get further information
+ `--max-rate` and `--min-rate` can be used to control the speed of the scan
	+ `-T0` to `-T5` are presets for speed

#### Less useful flags :
+ `-Ox file.xml` to export results to an XML file

#### Responses :
+ **Filtered** : Possibly behind a firewall
+ **Open** : Open port

#### Methods of scanning:
+ TCP Scans:
	+ Normal open :
		 + ![[Basic_TCP_scan.svg]]
	 + Normal closed :
		 + ![[Basic_TCP_scan_closed.svg]]
	 + Stealth Scan :
		 + ![[Stealth_TCP_scan.svg]]
	 + Service version :
		 + ![[SV_TCP_scan.svg]]


## Scripting
To use a script : `nmap --script script-name`
To pass arguments : `--script-args`